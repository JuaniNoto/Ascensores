<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/styles.css">
    <title>Document</title>
</head>
<body>
    
    <%- include('../partials/header.ejs') %>

    <main>
        <div class="tableSection">
            <h3>Registrar Compras</h3>
            <div class="table">
                <table id="compras" class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th>CUIT</th>
                            <th>Razon Social</th>
                            <th>Fecha</th>
                            <th>Tipo de Cbte</th>
                            <th>Numero de Cbte</th>
                            <th>Monto</th>
                            <th>IVA %</th>
                            <th>Retención</th>
                            <th>Detalle</th>
                            <% if ( hayUnUsuario.admin_id == 1 ){ %>
                            <th>Editar</th>
                            <th>Eliminar</th>
                            <% } %>
                        </tr>
                    </thead>
                    
                    <tbody>
                        <% for(let i = 0; i < compras.length; i++) { %>
                        <tr>
                            <td><%=compras[i].cuit%></td>
                            <td><%=compras[i].razon_social%></td>
                            <td><%=compras[i].fecha%></td>
                            <td><%=compras[i].tipoCbte.descripcion%></td>
                            <td><%=compras[i].nro_comprobante%></td>
                            <td>$ <%=compras[i].monto_neto%></td>
                            <td>$ <%=compras[i].iva_monto%></td>
                            <td>$ <%=compras[i].retencion_monto%></td>
                            <td><%=compras[i].fecha%></td>
                            <% if ( hayUnUsuario.admin_id == 1 ){ %>
                            <td><a href="/admin/compras/edit/<%=compras[i].id%>"><i class="far fa-edit"></i></a></td>
                            <td>
                                <form action="/admin/compras/delete/<%=compras[i].id%>?_method=DELETE" method="POST">
                                    <button type="submit">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </form>
                            </td>
                            <% } %>
                        </tr> 
                        <% } %>                    
                    </tbody>
                    <tfoot>
                        <tr>
                            <th>CUIT</th>
                            <th>Razon Social</th>
                            <th>Fecha</th>
                            <th>Tipo de Cbte</th>
                            <th>Numero de Cbte</th>
                            <th>Monto</th>
                            <th>IVA %</th>
                            <th>Retención</th>
                            <th>Detalle</th>
                            <% if ( hayUnUsuario.admin_id == 1 ){ %>
                            <th>Editar</th>
                            <th>Eliminar</th>
                            <% } %>
                        </tr>
                    </tfoot>
                </table>

                <a href="/admin/compras/registrar" class="crearNuevo">+ Agregar Nuevo</a>

            </div>
        </div>
    </main>
    
    <%- include('../partials/footer.ejs') %>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap4.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#compras').DataTable();
        } );
    </script>

</body>
</html>